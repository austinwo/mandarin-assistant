<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>English â†’ Mandarin AI</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta
      name="description"
      content="AI assistant that turns everyday English into Thai, Mandarin (simplified & traditional), pinyin, and Mandarin written with Thai phonetics."
    >

    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    >

    <!-- Custom Styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  </head>

  <body>
    <div class="container py-5">
      
      <!-- Error Message -->
      {% if error %}
      <div class="alert alert-danger text-center mx-auto" style="max-width: 800px;" role="alert">
        <strong>Error:</strong> {{ error }}
      </div>
      {% endif %}

      <!-- Header -->
      <header class="row justify-content-center mb-4">
        <div class="col-lg-10 mx-auto">
          <h1 class="mb-2">English â†’ Mandarin AI</h1>
          <p class="subtitle mb-0">
            Type what you want to say in <strong>English</strong>.<br>
            I'll return Thai, Mandarin (simplified/traditional), Pinyin, and Mandarin written with Thai letters.
          </p>
        </div>
      </header>

      <!-- Main -->
      <main class="row justify-content-center">
        <div class="col-lg-10 mx-auto">

          <!-- Translate card -->
          <section aria-label="Translate phrase">
            <div class="card shadow-lg mb-3">
              <form method="POST" id="main-form">
                <input type="hidden" name="action" value="translate">

                <div class="mb-3">
                  <label for="query" class="form-label">What do you want to say?</label>
                  <input
                    type="text"
                    class="form-control"
                    id="query"
                    name="query"
                    placeholder="e.g. I'm Thai but I live in the US"
                    value="{{ user_input or '' }}"
                    autocomplete="off"
                    autofocus
                  >
                </div>

                <div class="d-flex justify-content-between align-items-center gap-3">
                  <button type="submit" class="btn btn-primary submit-btn">
                    Translate
                  </button>

                  {% if score is not none %}
                    <span class="score-pill">
                      Similarity: {{ score }}
                    </span>
                  {% endif %}
                </div>

                <!-- Loading -->
                <div id="loading-indicator" class="d-none text-center mt-4">
                  <div class="spinner-border"></div>
                  <div class="loading-text mt-2">Thinking in Mandarinâ€¦</div>
                </div>
              </form>
            </div>
          </section>

          <!-- Random phrase card -->
          <section aria-label="Random example">
            <div class="card inspire-card shadow-lg mb-4 text-center">
              <form method="POST" id="random-form">
                <input type="hidden" name="action" value="random">
                <button
                  type="submit"
                  class="btn btn-outline-secondary btn-lg submit-btn w-100"
                >
                  ðŸŽ² Inspire me â€” show a random phrase
                </button>
              </form>
            </div>
          </section>

          <!-- Results -->
          <section aria-label="Results">
            <div id="results-area">
              {% if result %}
              <div class="result-card">
                <h5 class="mb-3">Result</h5>

                <div class="result-line">
                  <span class="result-label">EN</span>
                  <span class="result-value">{{ result.en }}</span>
                </div>

                <div class="result-line">
                  <span class="result-label">TH</span>
                  <span class="result-value">{{ result.thai }}</span>
                </div>

                <div class="result-line">
                  <span class="result-label">ZH Trad</span>
                  <span class="result-value">{{ result.zh_trad }}</span>
                </div>

                <div class="result-line">
                  <span class="result-label">ZH Simpl</span>
                  <span class="result-value">{{ result.zh }}</span>
                </div>

                <div class="result-line">
                  <span class="result-label">Pinyin</span>
                  <span class="result-value">{{ result.pinyin }}</span>
                </div>

                <div class="result-line">
                  <span class="result-label">ZH-TH</span>
                  <span class="result-value">{{ result.zh_thai }}</span>
                </div>

                {% if rag_answer %}
                <div class="rag-card mt-4">
                  <h6 class="mb-2">AI explanation & usage</h6>
                  <p class="rag-text">
                    {{ rag_answer | replace('\n', '<br>') | safe }}
                  </p>
                </div>
                {% endif %}
              </div>
              {% endif %}

              {% if suggestions and not no_good_match %}
              <div class="suggestions-card mt-3">
                <p class="text-muted small mb-2">Similar phrases:</p>
                <div class="suggestions-list">
                  {% for s in suggestions %}
                    <span class="suggestion-pill">{{ s }}</span>
                  {% endfor %}
                </div>
              </div>
              {% endif %}
            </div>
          </section>

        </div>
      </main>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- App JS -->
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
  </body>
</html>